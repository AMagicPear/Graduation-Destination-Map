<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <title>聚是一团火，散是满天星 | 江苏省木渎高级中学22届7班毕业去向图</title>

  <script type="text/javascript" src="https://registry.npmmirror.com/echarts/3.8.0/files/dist/echarts.min.js"></script>
  <script type="text/javascript" src="https://registry.npmmirror.com/jquery/3.7.1/files/dist/jquery.min.js"></script>
  <style>
    @font-face {
      font-family: 'AlibabaPuHuiTi';
      src: url('fonts/AlibabaPuHuiTi-3-45-Light.woff2') format('woff2');
      font-weight: 300;
      /* Light */
      font-style: normal;
    }

    @font-face {
      font-family: 'AlibabaPuHuiTi';
      src: url('fonts/AlibabaPuHuiTi-3-55-Regular.woff2') format('woff2');
      font-weight: 400;
      /* Regular */
      font-style: normal;
    }

    @font-face {
      font-family: 'AlibabaPuHuiTi';
      src: url('fonts/AlibabaPuHuiTi-3-65-Medium.woff2') format('woff2');
      font-weight: 500;
      /* Medium */
      font-style: normal;
    }

    @font-face {
      font-family: 'AlibabaPuHuiTi';
      src: url('fonts/AlibabaPuHuiTi-3-75-SemiBold.woff2') format('woff2');
      font-weight: 600;
      /* SemiBold */
      font-style: normal;
    }

    @font-face {
      font-family: 'AlibabaPuHuiTi';
      src: url('fonts/AlibabaPuHuiTi-3-85-Bold.woff2') format('woff2');
      font-weight: 700;
      /* Bold */
      font-style: normal;
    }
  </style>
  <script type="text/javascript" src="./maps/china.js"></script>
</head>

<body>
  <!-- 为 ECharts 准备一个定义了宽高的 DOM -->
  <div id="chart-panel" style="width: calc(100vw - 200px);height:calc(100vh - 200px); padding: 100px; margin: 0 auto;">
  </div>
  <script type="text/javascript">
    // 基于准备好的dom，初始化echarts实例
    var myChart = echarts.init(document.getElementById('chart-panel'));
    // 指定图表的配置项和数据
    var option = {};
    var name_title = "江苏省木渎高级中学22届7班毕业去向图"
    var subname = 'Deployed by AMagicPear'
    var nameColor = "#000"
    var name_fontFamily = 'AlibabaPuHuiTi'
    var subname_fontSize = 15
    var name_fontSize = 18
    var mapName = 'china'
    var data = [
      { name: "江苏", value: 41 },
      { name: "辽宁", value: 1 },
      { name: "吉林", value: 2 },
      { name: "陕西", value: 2 },
      { name: "北京", value: 1 },
      { name: "四川", value: 1 },
      { name: "重庆", value: 1 },
      { name: "上海", value: 2 },
      { name: "福建", value: 1 },
    ];

    var geoCoordMap = {};
    var toolTipData = [
      { name: "北京", value: [{ name: "中央财经大学", value: "赵晨曦" }] },
      {
        name: "江苏",
        value: [
          { name: "南京大学", value: "王俊杰" },
          { name: "东南大学", value: "王佳敏 钱佳裕" },
          { name: "南京师范大学", value: "朱熙晴 顾束逸佳 李泽楷 刘欣" },
          { name: "南京林业大学", value: "朱徐杰 鱼家乐" },
          { name: "南京信息工程大学", value: "赵乐 费心阳 杭芫 曹玉豪" },
          { name: "南京邮电大学", value: "黄灿 沈立" },
          { name: "南京医科大学", value: "李雨桐 徐子朝 秦子才 王培荣" },
          { name: "南京财经大学", value: "邢莹 杨绮洵" },
          { name: "河海大学", value: "王劲舟" },
          { name: "苏州大学", value: "黄欣妍 张程程 吴溢乐 薛连涛" },
          { name: "苏州科技大学", value: "陆霄 潘研" },
          { name: "江南大学", value: "孔维凯 陶琳" },
          { name: "中国矿业大学", value: "潘星恒" },
          { name: "徐州医科大学", value: "颜红霞" },
          { name: "南京审计大学", value: "周昰有 周启新" },
          { name: "江苏警官学院", value: "倪子衡" },
          { name: "江苏师范大学", value: "沈琪" },
          { name: "西交利物浦大学", value: "沈艺" },
          { name: "常州大学", value: "戚一苇" },
          { name: "扬州大学", value: "庄薛卉 徐子言" },
          { name: "常熟理工学院", value: "金宁一" }
        ]
      },
      { name: "辽宁", value: [{ name: "东北大学", value: "胡文波" }] },
      { name: "吉林", value: [{ name: "吉林大学", value: "程炳翔 侯心怡" }] },
      { name: "陕西", value: [{ name: "西安交通大学", value: "朱天杨 包皖暄" }] },
      { name: "四川", value: [{ name: "四川大学", value: "席颖" }] },
      { name: "重庆", value: [{ name: "重庆大学", value: "高李姝缘" }] },
      { name: "福建", value: [{ name: "厦门大学", value: "沙宇轩" }] },
      {
        name: "上海", value: [{ name: "上海健康医学院", value: "王宇鑫" },
        { name: "上海政法学院", value: "伍琪" }
        ]
      },
    ];

    /*获取地图数据*/
    myChart.showLoading();
    var mapFeatures = echarts.getMap(mapName).geoJson.features;
    myChart.hideLoading();
    mapFeatures.forEach(function (v) {
      // 地区名称
      var name = v.properties.name;
      // 地区经纬度
      geoCoordMap[name] = v.properties.cp;

    });

    // console.log("============geoCoordMap===================")
    // console.log(geoCoordMap)
    // console.log("================data======================")
    console.log(data)
    console.log(toolTipData)
    var max = 480,
      min = 9; // todo 
    var maxSize4Pin = 100,
      minSize4Pin = 20;

    var convertData = function (data) {
      var res = [];
      for (var i = 0; i < data.length; i++) {
        var geoCoord = geoCoordMap[data[i].name];
        if (geoCoord) {
          res.push({
            name: data[i].name,
            value: geoCoord.concat(data[i].value),
          });
        }
      }
      return res;
    };
    option = {
      title: {
        text: name_title,
        subtext: subname,
        x: 'center',
        textStyle: {
          color: nameColor,
          fontFamily: name_fontFamily,
          fontSize: name_fontSize,
        },
        subtextStyle: {
          fontSize: subname_fontSize,
          fontFamily: name_fontFamily
        }
      },
      tooltip: {
        trigger: 'item',
        formatter: function (params) {
          var toolTiphtml = '';
          for (var i = 0; i < toolTipData.length; i++) {
            if (params.name == toolTipData[i].name) {
              toolTiphtml += `<strong>${toolTipData[i].name}</strong><br>`;
              for (var j = 0; j < toolTipData[i].value.length; j++) {
                toolTiphtml += toolTipData[i].value[j].name + '：' + toolTipData[i].value[j].value + "<br>";
              }
            }
          }
          console.log(toolTiphtml);
          // console.log(convertData(data))
          return toolTiphtml;
        }
      },
      // legend: {
      //     orient: 'vertical',
      //     y: 'bottom',
      //     x: 'right',
      //     data: ['credit_pm2.5'],
      //     textStyle: {
      //         color: '#fff'
      //     }
      // },
      visualMap: {
        show: true,
        min: 0,
        max: 200,
        left: 'left',
        top: 'bottom',
        text: ['高', '低'], // 文本，默认为数值文本
        calculable: true,
        seriesIndex: [1],
        inRange: {
          color: ['#3B5077', '#031525'] // 蓝黑
          // color: ['#ffc0cb', '#800080'] // 红紫
          // color: ['#3C3B3F', '#605C3C'] // 黑绿
          // color: ['#0f0c29', '#302b63', '#24243e'] // 黑紫黑
          // color: ['#23074d', '#cc5333'] // 紫红
          // color: ['#00467F', '#A5CC82'] // 蓝绿
          // color: ['#1488CC', '#2B32B2'] // 浅蓝
          // color: ['#00467F', '#A5CC82'] // 蓝绿
          // color: ['#00467F', '#A5CC82'] // 蓝绿
          // color: ['#00467F', '#A5CC82'] // 蓝绿
          // color: ['#00467F', '#A5CC82'] // 蓝绿

        }
      },
      /*工具按钮组*/
      // toolbox: {
      //     show: true,
      //     orient: 'vertical',
      //     left: 'right',
      //     top: 'center',
      //     feature: {
      //         dataView: {
      //             readOnly: false
      //         },
      //         restore: {},
      //         saveAsImage: {}
      //     }
      // },
      geo: {
        show: true,
        map: mapName,
        label: {
          normal: {
            show: false
          },
          emphasis: {
            show: false,
          }
        },
        roam: true,
        itemStyle: {
          normal: {
            areaColor: '#031525',
            borderColor: '#3B5077',
          },
          emphasis: {
            areaColor: '#2B91B7',
          }
        }
      },
      series: [{
        name: '散点',
        type: 'scatter',
        coordinateSystem: 'geo',
        data: convertData(data),
        symbolSize: function (val) {
          return val[2] / 10;
        },
        label: {
          normal: {
            formatter: '{b}',
            position: 'right',
            show: true
          },
          emphasis: {
            show: true
          }
        },
        itemStyle: {
          normal: {
            color: '#05C3F9'
          }
        }
      },
      {
        type: 'map',
        map: mapName,
        geoIndex: 0,
        aspectScale: 0.75, //长宽比
        showLegendSymbol: false, // 存在legend时显示
        label: {
          normal: {
            show: true
          },
          emphasis: {
            show: false,
            textStyle: {
              color: '#fff'
            }
          }
        },
        roam: true,
        itemStyle: {
          normal: {
            areaColor: '#031525',
            borderColor: '#3B5077',
          },
          emphasis: {
            areaColor: '#2B91B7'
          }
        },
        animation: false,
        data: data
      },
      {
        name: '点',
        type: 'scatter',
        coordinateSystem: 'geo',
        symbol: 'pin', //气泡
        symbolSize: function (val) {
          var a = (maxSize4Pin - minSize4Pin) / (max - min);
          var b = minSize4Pin - a * min;
          b = maxSize4Pin - a * max;
          return a * val[2] + b;
        },
        label: {
          normal: {
            show: true,
            textStyle: {
              color: '#fff',
              fontSize: 8,
            }
          }
        },
        itemStyle: {
          normal: {
            color: '#F62157', //标志颜色
          }
        },
        zlevel: 6,
        data: convertData(data),
      },
      {
        name: 'Top 5',
        type: 'effectScatter',
        coordinateSystem: 'geo',
        data: convertData(data.sort(function (a, b) {
          return b.value - a.value;
        }).slice(0, 5)),
        symbolSize: function (val) {
          return val[2] / 10;
        },
        showEffectOn: 'render',
        rippleEffect: {
          brushType: 'stroke'
        },
        hoverAnimation: true,
        label: {
          normal: {
            formatter: '{b}',
            position: 'right',
            show: true
          }
        },
        itemStyle: {
          normal: {
            color: 'yellow',
            shadowBlur: 10,
            shadowColor: 'yellow'
          }
        },
        zlevel: 1
      },

      ]
    };
    myChart.setOption(option);
    //=============== end ===============//

    // 使用刚指定的配置项和数据显示图表。
    if (option && typeof option === 'object') {
      myChart.setOption(option);
    }
    window.addEventListener('resize', myChart.resize);
  </script>
  <script src="https://giscus.app/client.js" data-repo="amagicpear/Graduation-Destination-Map"
    data-repo-id="R_kgDONPHlSw" data-category="General" data-category-id="DIC_kwDONPHlS84CkQU1" data-mapping="pathname"
    data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top"
    data-theme="preferred_color_scheme" data-lang="zh-CN" data-loading="lazy" crossorigin="anonymous" async>
    </script>
</body>

</html>